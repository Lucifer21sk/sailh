<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Ofici√°lna str√°nka SAILH ‚Äì Slovensk√° asoci√°cia in-line hokeja. Live v√Ωsledky." />
    <meta name="author" content="SAILH" />
    <title>SAILH - Domov</title>
    <link rel="stylesheet" href="styles.css" />
    <style>
        /* CSS pre pulzuj√∫ce tlaƒçidlo LIVE */
        .live-btn-dynamic {
            display: inline-block;
            background: #d90f23;
            color: white;
            padding: 5px 12px;
            border-radius: 4px;
            text-decoration: none;
            font-weight: bold;
            font-size: 0.8em;
            text-transform: uppercase;
            animation: pulse-live 2s infinite;
            margin-bottom: 15px;
        }
        @keyframes pulse-live { 
            0% { opacity: 1; transform: scale(1); } 
            50% { opacity: 0.8; transform: scale(1.05); } 
            100% { opacity: 1; transform: scale(1); } 
        }

        /* ≈†t√Ωl pre d√°tum v kalend√°ri */
        .calendar-date-highlight {
            color: #244b94; 
            font-weight: 900; 
            font-size: 1.1em;
            margin-bottom: 2px;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">
            <picture>
                <source srcset="logo_80.webp 1x, logo_160.webp 2x, logo_200.webp 3x" type="image/webp">
                <source srcset="logo_80.png 1x, logo_160.png 2x, logo_200.png 3x" type="image/png">
                <img src="logo_80.png" alt="SAILH Logo" class="logo-img">
            </picture>
        </div>
        <div class="site-title">Slovensk√° asoci√°cia in-line hokeja</div>
        <nav class="menu" role="navigation" aria-label="Hlavn√© menu">
            <a href="index.html" class="active">Domov</a>
            <a href="standing.html">Extraliga</a>
            <a href="https://www.inlineliga.sk">Amat√©rska liga</a>
            <a href="clubs.html">Kluby</a>
            <a href="https://www.mihwa.org/">MIHWA</a>
            <a href="gallery.html">Gal√©ria</a>            
            <a href="partners.html">Partneri</a>              
        </nav>
    </header>

    <div class="video-banner">
        <video autoplay muted loop playsinline class="banner-video">
            <source src="banner.mp4" type="video/mp4" />
        </video>
    </div>

    <div class="dashboard-grid" style="display: grid; grid-template-columns: 580px 1fr 200px; gap: 15px; max-width: 1650px; margin: 0 auto;">
        
        <aside class="dashboard-left">
            <h3 style="color:#244b94; border-bottom:2px solid #d90f23; padding-bottom:10px; margin-top:0;">üìÖ Kalend√°r</h3>
            <div id="calendarList" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; max-height: 600px; overflow-y: auto; padding-right:5px;">
                <p>Naƒç√≠tavam...</p>
            </div>
        </aside>

        <main class="dashboard-center">
            <div class="live-scoreboard-section" style="margin-top:0; padding:0; background:transparent; box-shadow:none;">
                <h2 style="text-align:center; color:#d90f23; margin-top:25px;">Live Z√°pasy</h2>
                <div id="matchList" class="match-container">
                    <p style="text-align:center;">Naƒç√≠tavam z√°pasy...</p>
                </div>
            </div>
        </main>

        <aside class="dashboard-right">
            <a href="standing.html" class="action-btn btn-results">
                üìä V√Ωsledky & Tabuƒæky
            </a>
        </aside>

    </div>

    <footer class="footer">
        <div class="footer-container">      
            <div class="footer-col">
                <h4 class="footer-title">SAILH</h4>
                <div class="footer-line"></div>
                <p class="footer-text">
                    Slovensk√° asoci√°cia in-line hokeja.<br>
                    Oreganov√° 1178/1<br>
                    900 46 Most pri Bratislave<br>
                    Studen√©
                </p>
                <p class="footer-text" style="margin-top: 15px; font-size: 0.85em; opacity: 0.7;">
                    Registraƒçn√© ƒç√≠slo: VVS/1-900/90-72711
                </p>
            </div>
            <div class="footer-col">
                <h4 class="footer-title">R√Ωchle Odkazy</h4>
                <div class="footer-line"></div>
                <ul class="footer-links">
                    <li><a href="https://ives.minv.sk/rmno/detail/13542098669735168654">O asoci√°cii</a></li>
                    <li><a href="privacy-policy.html">Ochrana √∫dajov</a></li>
                    <li><a href="donate.html">Darujte 2%</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4 class="footer-title">Kontakt</h4>
                <div class="footer-line"></div>
                <div class="contact-item">
                    <span class="icon">üìß</span> 
                    <a href="mailto:pejchalr@gmail.com">pejchalr@gmail.com</a>
                </div>
                <div class="contact-item">
                    <span class="icon">üìû</span> 
                    <span>+421 905 627 715</span>
                </div>
                <div class="contact-item" style="margin-top: 20px;">
                    <strong style="color:#d90f23; margin-right:5px;">IƒåO:</strong> 57133671
                </div>
                <div class="contact-item">
                    <strong style="color:#d90f23; margin-right:5px;">DIƒå:</strong> 2122632930
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            ¬© 2026 SAILH - V≈°etky pr√°va vyhraden√©
        </div>
    </footer>

    <script>
        const API_BASE = "https://Lucifer21sk.pythonanywhere.com";

        async function loadCalendar() {
            try {
                const res = await fetch(`${API_BASE}/matches`);
                const allMatches = await res.json();
                const box = document.getElementById("calendarList");
                
                const matches = allMatches.filter(m => !m.is_finished && m.status !== "live");

                if (matches.length === 0) {
                    box.innerHTML = "<p style='color:#666; font-size:0.9em; padding:10px; grid-column: 1 / span 3;'>≈Ωiadne napl√°novan√© z√°pasy.</p>";
                    return;
                }

                matches.sort((a, b) => new Date(a.date + ' ' + a.time) - new Date(b.date + ' ' + b.time));

                box.innerHTML = "";
                matches.forEach(m => {
                    // --- ZMENA FORM√ÅTU D√ÅTUMU ---
                    // Predpoklad: m.date je "RRRR-MM-DD"
                    const parts = m.date.split('-');
                    // Vytvor√≠me "DD.MM.RRRR" (alebo "DD-MM-RRRR" ak chcete pomlƒçky)
                    const formattedDate = `${parts[2]}.${parts[1]}.${parts[0]}`; 
                    // ----------------------------

                    let liveBtn = "";
                    if (m.livestream_url && m.livestream_url.length > 5) {
                        liveBtn = `<br><a href="${m.livestream_url}" target="_blank" class="live-btn-dynamic">‚ñ∂ LIVE</a>`;
                    }

                    box.innerHTML += `
                        <div class="upcoming-item" style="background:#fff; border:1px solid #eee; padding:8px; border-radius:6px; text-align:center; box-shadow: 0 1px 3px rgba(0,0,0,0.05);">
                            <div style="margin-bottom:5px;">
                                <div class="calendar-date-highlight">${formattedDate}</div>
                                <div style="font-size:0.9em; font-weight:bold; color:#555;">${m.time}</div>
                            </div>
                            <div style="font-size:0.75em; width:100%; border-top:1px solid #f0f0f0; padding-top:5px;">
                                <div style="font-weight:bold; color:#000;">${m.home_team}</div>
                                <div style="color:#999; margin:2px 0;">vs</div>
                                <div style="font-weight:bold; color:#000;">${m.away_team}</div>
                                ${liveBtn}
                            </div>
                        </div>
                    `;
                });
            } catch(e) { console.error(e); }
        }

        async function loadMatches() {
            try {
                const [resPublic, resAll] = await Promise.all([
                    fetch(`${API_BASE}/matches/public`),
                    fetch(`${API_BASE}/matches`)
                ]);
                
                const liveData = await resPublic.json();
                const allMatches = await resAll.json();

                const activeMatches = liveData.filter(m => m.status === "live");
                const container = document.getElementById("matchList");
                container.innerHTML = ""; 

                if (activeMatches.length === 0) {
                    container.innerHTML = "<p style='text-align:center; padding:20px;'>Aktu√°lne sa nehraj√∫ ≈æiadne z√°pasy.</p>";
                    return;
                }

                activeMatches.forEach(m => {
                    const matchInfo = allMatches.find(x => x.id === m.id);
                    const streamUrl = (matchInfo && matchInfo.livestream_url) ? matchInfo.livestream_url : null;

                    const statusIndicator = streamUrl 
                        ? `<a href="${streamUrl}" target="_blank" class="live-btn-dynamic" style="font-size:0.9em; padding:8px 16px;">üî¥ SLEDOVA≈§ LIVE</a>`
                        : `<div class="status-badge status-live" style="background:#d90f23; color:white; padding:4px 10px; border-radius:12px; font-size:0.8em; font-weight:bold; display:inline-block; margin-bottom:10px;">NA≈ΩIVO</div>`;
                    
                    let phaseText = m.phase === "normal" ? "Z√°kladn√° hracia doba" : m.phase;

                    let eventsHtml = "";
                    if (m.events && m.events.length > 0) {
                        eventsHtml = '<div style="margin-top: 20px; border-top: 1px solid #ddd; padding-top: 10px; display: flex; flex-direction: column; gap: 8px;">';
                        m.events.forEach(e => {
                            let alignStyle = (e.side === "home") ? "align-self: flex-start; text-align: left;" : "align-self: flex-end; text-align: right;";
                            let boxStyle = "padding: 6px 12px; border-radius: 6px; font-weight: bold; font-size: 0.95em; display: inline-block; max-width: 80%; background:" + (e.side === "home" ? "#e3f2fd" : "#fce4ec") + "; color:" + (e.side === "home" ? "#1565c0" : "#c2185b") + ";";
                            eventsHtml += `<div style="${alignStyle}"><div style="${boxStyle}">${e.scorer}</div></div>`;
                        });
                        eventsHtml += '</div>';
                    }

                    container.innerHTML += `
                        <div class="match-card" style="background:white; padding:15px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); margin-bottom:15px; text-align:center;">
                            ${statusIndicator}
                            <div style="display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; gap:15px;">
                                <div style="font-weight:bold;">${m.home_team}</div>
                                <div style="font-size:1.8em; font-weight:800; color:#244b94; background:#f4f8ff; padding:5px 15px; border-radius:8px;">${m.home_score} - ${m.away_score}</div>
                                <div style="font-weight:bold;">${m.away_team}</div>
                            </div>
                            <div style="color:#666; font-size:0.9em; margin-top:10px;">${phaseText}</div>
                            ${eventsHtml}
                        </div>
                    `;
                });
            } catch (err) { console.error(err); }
        }

        loadCalendar();
        loadMatches();
        setInterval(loadMatches, 5000); 
    </script>
</body>
</html>